{
  "hash": "cd07c70aab52a412b7649bcbea8591ad",
  "result": {
    "markdown": "---\ntitle: Add a Generated Table of Contents Anywhere in RMarkdown\ndate: '2018-02-28'\nslug: add-a-generated-table-of-contents-anywhere-in-rmarkdown\naliases:\n  - /blog/2018/02/28/add-a-generated-table-of-contents-anywhere-in-rmarkdown\ncategories:\n  - Blog\ntags:\n  - Markdown\n  - pandoc\n  - R\n  - Tricks\n  - blogdown\n  - R Markdown\n---\n\n\n\n\n<!-- Links -->\n[render-toc-gist]: https://gist.github.com/gadenbuie/c83e078bf8c81b035e32c3fc0cf04ee8\n[blogdown-gh]: https://github.com/rstudio/blogdown\n[blogdown-issue]: https://github.com/rstudio/blogdown/issues/267\n[stanstrup-gh]: https://github.com/stanstrup\n[hugo-academic]: https://github.com/gcushen/hugo-academic\n[my-theme]: https://github.com/gadenbuie/hyde\n\n**Links:** [Github Gist][render-toc-gist]\n\nGitHub user [\\@stanstrup][stanstrup-gh] posted [a question][blogdown-issue] today on the [blogdown GitHub repo][blogdown-gh] about manually positioning a table of contents in blogdown:\n\n> When I use `toc: true` in a post the toc is inserted at the very top of the post.\n> ... If you could specify the position of the toc with some keyword you could work around it.\n\nI don't use the [academic theme for Hugo][hugo-academic] (I use a modified version of [hyde][my-theme]), so I'm not entirely sure if I can completely solve stanstrup's problems, but I know I've run into something similar recently.\n\nAnd while Yihui is probably right that [the effort isn't worth it](https://github.com/rstudio/blogdown/issues/267#issuecomment-369272039) when fiddling with trivial aesthetics, I use R Markdown in enough places and have run into this a few times.\nKnowing that someone else out there felt the same pain was enough to push me to code up a quick solution.\n\nThe function I've worked up is called `render_toc()` and it allows you to drop in a table of contents anywhere inside an R Markdown document.\nThis means you can use it to manually position a table of contents in:\n\n- A README file for your package repo\n- In a long blogdown post\n- In an overview slide in xaringan\n\nand many more places.\n\n## Get It\n\nI've posted [the function and an example document as a GitHub Gist][render-toc-gist].\nTo use it in your document, choose one of the following:\n\n1. Download `render_toc.R` and `source(\"render_toc.R\")` in your project or script\n\n2. Copy the function code into your RMarkdown document\n\n3. Source the function from GitHub using `devtools`:\n\n    ```r\n    devtools::source_gist(\"c83e078bf8c81b035e32c3fc0cf04ee8\", \n                          filename = 'render_toc.R')\n    ```\n    \n## Use It\n\nI included an example file in the [GitHub Gist][render-toc-gist].\nEssentially, you just need to source `render_toc.R` somewhere (such as a setup chunk) and then call it in the document where you want to render the table of contents.\n\nThe output will just be a markdown list, so if you want to give the table of contents it's own header, you'll have to include that in the document.\n\nHere's what a simple R Markdown document would look like.\n\n````\n```{r setup, include=FALSE} \nknitr::opts_chunk$set(echo = TRUE)\ndevtools::source_gist(\"c83e078bf8c81b035e32c3fc0cf04ee8\", \n                      filename = 'render_toc.R')\n```\n\n## Table of Contents\n\n```{r toc, echo=FALSE} \nrender_toc(\"blogdown-toc-example.Rmd\")\n```\n\n# Writing\n\n## R Markdown\n\nThis is an R Markdown document...\n\n```{r cars} \n# This is not a header\nsummary(cars)\n```\n\n## Regular Code\n\n```r\n# Regular markdown code (not run)\nplot(pressure)\n```\n\n# Plots\n\n## Including Plots {#plots-are-here .class-foo}\n\nYou can also embed plots, for example:\n\n```{r pressure, echo=FALSE} \nplot(pressure)\n```\n````\n\nwhich outputs as \n<a href=\"/images/2018/2018-02-28-blogdown-toc-example.png\" data-featherlight=\"image\">this document (click to view image)</a>.\n\n## Behind the Scenes\n\nThe function simply reads through the lines of the RMarkdown document and strips out any code blocks.\nThe supported code fencing style is three or more &grave; characters in a row.\n\nThen I extract the headers, which must be in the hashtag-style to work.\nIn other words headers like this\n\n```\n## A Nice Header\n```\n\nwork well, while headers like these won't be processed\n\n```\nA Not So Nice Header\n====================\n```\n\nThe function creates the header anchor if not manually specified -- see the [pandoc header identifiers](http://pandoc.org/MANUAL.html#header-identifiers) help page for more information -- or uses the identifier if it is included.\n\nThe example above would link to `#a-nice-header` and the example below links to `#my-shortcut`\n\n```\n## An Overly Wordy Header Title {#my-shortcut}\n```\n\nAny headers with a higher depth than the `toc_depth` parameter (default is `3`) are discarded.\nAlso any initial headers prior to the first base level header with higher levels (say `###` when the base level is `##`) are discarded as well.\n\nFinally, if `toc_header_name` is set, the header with that name is discarded so that the TOC itself isn't included in the TOC.\n\nThe end result is a simple markdown list that can be rendered anywhere!\n\n\n::: {.cell hash='add-a-generated-table-of-contents-anywhere-in-rmarkdown_cache/html/unnamed-chunk-1_56c1c8c07f00fbc23cc82675d41a937b'}\n\n```{.r .cell-code}\ndevtools::source_gist(\"c83e078bf8c81b035e32c3fc0cf04ee8\", \n                      filename = 'render_toc.R')\n\n# `this_post` is set in the setup chunk, \n# points to the Rmd file for this post\nrender_toc(this_post)\n```\n\n::: {.cell-output-display}\n- [Get It](#get-it)\n- [Use It](#use-it)\n- [Behind the Scenes](#behind-the-scenes)\n:::\n:::\n\n\nWhich, underneath, is just markdown.\n\n\n::: {.cell hash='add-a-generated-table-of-contents-anywhere-in-rmarkdown_cache/html/unnamed-chunk-2_46ddd891e14c03955cdc22d93cff4043'}\n::: {.cell-output .cell-output-stdout}\n```\n- [Get It](#get-it)\n- [Use It](#use-it)\n- [Behind the Scenes](#behind-the-scenes)\n```\n:::\n:::\n\n\n---\n\nLet me know on twitter [\\@grrrck](https://twitter.com/grrrck) if you found this helpful or run into any issues!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}